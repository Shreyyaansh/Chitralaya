<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Chitralaya</title>
    <link rel="stylesheet" href="chitra.css" />
    <script src="script.js"></script>
</head>

<body>
    <div class="header-container">
        <div class="navbar">
            <div class="logo">
                <span>‡§ö‡§ø‡§§‡•ç‡§∞‡§æ‡§≤‡§Ø|</span><span class="en">Chitralaya</span
                ><span class="icon">üé®</span>
            </div>

            <div class="nav-links">
                <a href="main.html#home">Home</a>
                <a href="main.html#gallery">Gallery</a>
                <a href="main.html#about">About</a>
                <a href="main.html#contact">Contact</a>
            </div>
        </div>

        <!-- User Actions -->
        <div class="user-actions">
            <a href="profile.html" class="user-action-btn" id="user-link">
                <img src="assets/user.png" alt="Profile" class="icon-img">
                <span id="user-text">Login</span>
            </a>
            <a href="cart.html" class="user-action-btn cart-btn">
                <img src="assets/shopping-cart.png" alt="Cart" class="icon-img">
                <span>Cart</span>
                <span class="cart-count" id="cart-count">0</span>
            </a>
        </div>
    </div>

    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="main.html">Home</a> ‚Ä∫ <span>Profile</span>
    </div>

    <main class="main-content">
        <div class="container">
            <div class="profile-container">
                <div class="profile-header">
                    <h1>My Profile</h1>
                    <p>Manage your account information and preferences</p>
                </div>

                <div class="profile-content">
                    <div class="profile-card">
                        <div class="profile-info">
                            <div class="profile-avatar">
                                <img src="assets/user.png" alt="Profile Avatar" id="profile-avatar">
                            </div>
                            <div class="profile-details">
                                <h2 id="profile-name">Loading...</h2>
                                <p id="profile-email">Loading...</p>
                            </div>
                        </div>
                        
                        <div class="profile-actions">
                            <button class="btn-primary" onclick="manageAddress()">Manage Address</button>
                            <button class="btn-secondary" onclick="viewOrders()">Your Orders</button>
                            <button class="btn-danger" onclick="logout()">Logout</button>
                        </div>
                    </div>


                </div>
            </div>
        </div>
    </main>

    <footer class="footer" id="about">
        <div class="footer-content">
            <div class="footer-section">
                <h3>About Chitralaya</h3>
                <p>Welcome to Chitralaya ‚Äî where colors speak. We showcase the original artworks created by my mother, each piece crafted with love and creativity. All artworks displayed here are available for purchase directly through our site.</p>
            </div>
            
            <div class="footer-section" id="contact">
                <h3>Contact Us</h3>
                <p>Get in touch with us for any inquiries about our artwork collection.</p>
                <div class="social-links">
                    <a href="mailto:mannu131376@gmail.com?subject=Inquiry from Chitralaya Website&body=Hello, I am interested in your artwork collection. Please contact me with more information." class="social-link">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        </svg>
                        <span>Email</span>
                    </a>
                    <a href="https://instagram.com/pratishtha0605" class="social-link">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                        </svg>
                        <span>Instagram</span>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Chitralaya. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Profile page specific JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            loadProfileData();
        });

        async function loadProfileData() {
            const token = localStorage.getItem('authToken');
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            
            if (!token || !currentUser) {
                // Redirect to login if not authenticated
                window.location.href = 'login.html';
                return;
            }

            try {
                // Load user profile data
                const response = await fetch('http://localhost:3000/api/auth/profile', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json',
                    }
                });

                const data = await response.json();

                if (data.success) {
                    const user = data.data.user;
                    updateProfileDisplay(user);
                } else {
                    console.error('Failed to load profile:', data.message);
                }
            } catch (error) {
                console.error('Error loading profile:', error);
                // Use cached user data if API fails
                if (currentUser) {
                    updateProfileDisplay(currentUser);
                }
            }
        }

        function updateProfileDisplay(user) {
            document.getElementById('profile-name').textContent = `${user.firstname} ${user.lastname}`;
            document.getElementById('profile-email').textContent = user.email;
        }


        function manageAddress() {
            // For now, show an alert. In a real app, this would open an address management modal or page
            alert('Address management feature coming soon! You will be able to add, edit, and delete your shipping addresses here.');
        }

        function viewOrders() {
            // For now, show an alert. In a real app, this would show order history
            alert('Order history feature coming soon! You will be able to view all your past orders, track their status, and download invoices here.');
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Clear local storage
                localStorage.removeItem('authToken');
                localStorage.removeItem('currentUser');
                
                // Redirect to home page
                window.location.href = 'main.html';
            }
        }
    </script>
</body>
</html>

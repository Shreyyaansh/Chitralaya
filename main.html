<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <!-- Page text uses UTF-8 encoding (so Devanagari and emoji render correctly). -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- makes th layout nice on mobile devices. -->
    <title>Chitralaya - Art Gallery & Online Store</title>
    <meta name="description" content="Chitralaya - Premium art gallery featuring canvas paintings, sketches, and color artworks. Buy authentic Indian art online.">
    <meta name="keywords" content="art gallery, paintings, sketches, canvas art, Indian art, online art store">
    <meta name="author" content="Chitralaya">
    <link rel="canonical" href="https://chitralaya.vercel.app">
    <meta property="og:title" content="Chitralaya - Art Gallery & Online Store">
    <meta property="og:description" content="Premium art gallery featuring canvas paintings, sketches, and color artworks. Buy authentic Indian art online.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://chitralaya.vercel.app">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Chitralaya - Art Gallery & Online Store">
    <meta name="twitter:description" content="Premium art gallery featuring canvas paintings, sketches, and color artworks.">
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari&family=Playfair+Display&display=swap"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"/>
    <noscript><link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari&family=Playfair+Display&display=swap"
      rel="stylesheet"/></noscript>
    <link rel="stylesheet" href="chitra.css" />
    <link rel="preload" href="script.js" as="script">
    <link rel="preload" href="config.js" as="script">
    <script src="config.js"></script>
    <script src="script.js" defer></script>
    <script>
      // Hidden admin access - press Ctrl+Shift+A to access admin panel
      document.addEventListener('DOMContentLoaded', function() {
        document.addEventListener('keydown', function(e) {
          if (e.ctrlKey && e.shiftKey && (e.key === 'A' || e.key === 'a')) {
            e.preventDefault();
            e.stopPropagation();
            window.location.href = 'admin.html';
            return false;
          }
        });
      });
    </script>
  </head>

  <body>
    <div class="navbar">
      <div class="logo">
        <span>‡§ö‡§ø‡§§‡•ç‡§∞‡§æ‡§≤‡§Ø|</span><span class="en">Chitralaya</span><span class="icon">üé®</span>
      </div>

      <div class="nav-links">
        <a href="#home">Home</a>
        <a href="#gallery">Gallery</a>
        <a href="#about">About</a>
        <a href="#contact">Contact</a>
      </div>
    </div>

   <div class="banner" id="home">
    <!-- User Actions -->
    <div class="user-actions">
      <a href="login.html" class="user-action-btn" id="user-link">
        <img src="assets/user.png" alt="Login" class="icon-img">
        <span id="user-text">Login</span>
      </a>
      <a href="cart.html" class="user-action-btn cart-btn">
        <img src="assets/shopping-cart.png" alt="Cart" class="icon-img">
        <span>Cart</span>
        <span class="cart-count" id="cart-count">0</span>
      </a>
    </div>
    <canvas id="spotlight"></canvas>
    
    <h1 class="heading">
      <span class="hi">‡§ö‡§ø‡§§‡•ç‡§∞‡§æ‡§≤‡§Ø</span>
      <span class="en">Where Colors Speak üé®</span>
    </h1>
    
    <div class="tagline">
      <span class="tagline-text">‚ú® Original artworks, crafted with love ‚Äî now available for you ‚ú®</span>
    </div>
  </div>

  <h1 class="hehe" id="gallery">PRODUCTS</h1>

  <!-- Filter Buttons -->
  <div class="filter-buttons">
    <button class="filter-btn active" onclick="filterArtwork('all')">All</button>
    <button class="filter-btn" onclick="filterArtwork('canvas')">Canvas</button>
    <button class="filter-btn" onclick="filterArtwork('sketches')">Sketches</button>
    <button class="filter-btn" onclick="filterArtwork('color')">Water Color</button>
  </div>

<div class="gallery" id="products-gallery">
  <!-- Products will be loaded dynamically from API -->
  <div class="loading-message" id="loading-message">
    <p>Loading beautiful artworks...</p>
  </div>
</div>

</div>

  <footer class="footer" id="about">
    <div class="footer-content">
      <div class="footer-section">
        <h3>About Chitralaya</h3>
        <p>Welcome to Chitralaya ‚Äî where colors speak. We showcase the original artworks created by my mother, each piece crafted with love and creativity. All artworks displayed here are available for purchase directly through our site.</p>
      </div>
      
      <div class="footer-section" id="contact">
        <h3>Contact Us</h3>
        <p>Get in touch with us for any inquiries about our artwork collection.</p>
        <div class="social-links">
          <a href="mailto:mannu131376@gmail.com?subject=Inquiry from Chitralaya Website&body=Hello, I am interested in your artwork collection. Please contact me with more information." class="social-link">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
            </svg>
            <span>Email</span>
          </a>
          <a href="https://instagram.com/pratishtha0605" class="social-link">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
            </svg>
            <span>Instagram</span>
          </a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2025 Chitralaya. All rights reserved.</p>
    </div>
  </footer>

  <script>
    // API Configuration (now loaded from config.js)
    let allProducts = [];
    let currentFilter = 'all';

    // Load products from API
    async function loadProducts() {
      try {
        const response = await fetch(`${window.API_BASE_URL}/products`);
        const data = await response.json();
        
        if (data.success) {
          allProducts = data.data.products;
          
          // Preload first few critical images
          preloadCriticalImages(allProducts.slice(0, 6));
          
          displayProducts(allProducts);
          hideLoadingMessage();
        } else {
          showErrorMessage('Failed to load products');
        }
      } catch (error) {
        showErrorMessage('Error loading products. Please check if the server is running.');
      }
    }

    // Preload first few images for instant display
    function preloadCriticalImages(products) {
      // Preload only the first 2 images for instant display
      const criticalProducts = products.slice(0, 4);
      
      criticalProducts.forEach(product => {
        if (product.images && product.images[0]) {
          const link = document.createElement('link');
          link.rel = 'preload';
          link.as = 'image';
          link.href = product.images[0];
          document.head.appendChild(link);
        }
      });
    }

    // Display products in the gallery
    function displayProducts(products) {
      const gallery = document.getElementById('products-gallery');
      gallery.innerHTML = '';

      products.forEach((product, index) => {
        const productElement = createProductElement(product, index);
        gallery.appendChild(productElement);
      });
    }

    // Product mapping to preserve original styling
    const productStyleMapping = {
      'Radha Krishna': { cardClass: 'card-1', adjustClass: 'adjust-position-1' },
      'Serene Walkway Landscape': { cardClass: 'card-2', adjustClass: 'adjust-position-2' },
      'Graceful Bird': { cardClass: 'card-3', adjustClass: '' },
      'Divine Krishna': { cardClass: 'card-4', adjustClass: '' },
      'Charming House': { cardClass: 'card-5', adjustClass: '' },
      'Majestic Peacock': { cardClass: 'card-6', adjustClass: '' },
      'Beautiful Girl': { cardClass: 'card-7', adjustClass: '' },
      'Divine Ganesha Portrait': { cardClass: 'card-8', adjustClass: '' },
      'Mystical Liquid Drip': { cardClass: 'card-9', adjustClass: '' },
      'Serene Young Girl': { cardClass: 'card-10', adjustClass: '' },
      'Elegant Traditional Woman': { cardClass: 'card-11', adjustClass: '' },
      'Majestic Tiger Portrait': { cardClass: 'card-12', adjustClass: '' },
      'Serene Mountain River': { cardClass: 'card-13', adjustClass: '' },
      'Ancient Stone Pavilion': { cardClass: 'card-14', adjustClass: '' },
      'Divine Shiva and Parvati': { cardClass: 'card-15', adjustClass: '' }
    };

    // Create product element
    function createProductElement(product, index) {
      const div = document.createElement('div');
      
      // Get styling info from database or fallback to mapping
      const styleInfo = {
        cardClass: product.cardClass || productStyleMapping[product.name]?.cardClass || `card-${index + 1}`,
        adjustClass: product.adjustClass || productStyleMapping[product.name]?.adjustClass || ''
      };
      
      div.className = `artwork-item ${styleInfo.cardClass}`;
      div.setAttribute('data-category', `all ${product.category}`);
      div.setAttribute('data-product-name', product.name);
      div.onclick = () => openProduct(product._id);

      // Use original image paths as they were working before
      const mainImage = product.images[0];
      const hoverImage = product.images[1] || product.images[0];
      
      // Use compressed images directly for fast loading
      const getOptimizedImageUrl = (imagePath) => {
        if (!imagePath) return '';
        // Return compressed image path directly
        return imagePath;
      };

      div.innerHTML = `
        <div class="artwork-image ${styleInfo.adjustClass}">
          <img src="${getOptimizedImageUrl(mainImage)}" alt="${product.name}" class="main-img" style="object-position: ${product.imagePosition || 'center'};" width="400" height="400">
          <img src="${getOptimizedImageUrl(hoverImage)}" alt="${product.name} Detail" class="hover-img" style="object-position: ${product.imagePosition || 'center'};" width="400" height="400">
        </div>
        <div class="artwork-info">
          <h3 class="artwork-title">${product.name}</h3>
          <div class="artwork-price">
            <span class="current-price">Rs. ${product.price.toLocaleString('en-IN', {minimumFractionDigits: 2})}</span>
          </div>
        </div>
      `;

      return div;
    }

    // Filter products by category
    function filterArtwork(category) {
      currentFilter = category;
      
      // Update active button
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      let filteredProducts = allProducts;
      
      if (category !== 'all') {
        filteredProducts = allProducts.filter(product => product.category === category);
      }
      
      displayProducts(filteredProducts);
    }

    // Open product page
    function openProduct(productId) {
      window.location.href = `product.html?id=${productId}`;
    }

    // Hide loading message
    function hideLoadingMessage() {
      const loadingMessage = document.getElementById('loading-message');
      if (loadingMessage) {
        loadingMessage.style.display = 'none';
      }
    }

    // Show error message
    function showErrorMessage(message) {
      const gallery = document.getElementById('products-gallery');
      gallery.innerHTML = `
        <div class="error-message">
          <p>‚ùå ${message}</p>
          <button onclick="loadProducts()" class="retry-btn">Retry</button>
        </div>
      `;
    }

    // Ensure cart counter is updated when main page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Load products from API
      loadProducts();
      
      // Update cart counter
      function updateCartCounter() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        const cartCountElement = document.getElementById('cart-count');
        if (cartCountElement) {
          cartCountElement.textContent = totalItems;
          cartCountElement.style.display = totalItems > 0 ? 'flex' : 'none';
        }
      }
      
      // Update on page load
      updateCartCounter();
      
      // Listen for cart changes
      window.addEventListener('storage', function(e) {
        if (e.key === 'cart') {
          updateCartCounter();
        }
      });
      
      // Listen for custom cart update events
      window.addEventListener('cartUpdated', function() {
        updateCartCounter();
      });
    });
  </script>
  <script src="image-optimizer.js"></script>
  <script src="config.js"></script>
     
  </body>
</html>
